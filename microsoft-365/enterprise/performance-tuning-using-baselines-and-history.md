---
title: ベースラインとパフォーマンス履歴を使用して、Office 365 のパフォーマンスをチューニングする
ms.author: tracyp
author: MSFTTracyP
manager: laurawi
ms.date: 8/31/2017
audience: Admin
ms.topic: conceptual
ms.service: o365-administration
localization_priority: Normal
f1.keywords:
- CSH
ms.custom:
- Adm_O365
- seo-marvel-apr2020
search.appverid:
- MET150
- MOE150
- BCS160
ms.assetid: 1492cb94-bd62-43e6-b8d0-2a61ed88ebae
ms.collection:
- M365-security-compliance
- Ent_O365
- SPO_Content
description: クライアントコンピューター接続の履歴をチェックして、早期に新しい問題を検出できるようにする方法について説明します。
ms.openlocfilehash: 2337b14542f894e9a62037b2f032632147e45e09
ms.sourcegitcommit: 79065e72c0799064e9055022393113dfcf40eb4b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/14/2020
ms.locfileid: "46691886"
---
# <a name="office-365-performance-tuning-using-baselines-and-performance-history"></a>ベースラインとパフォーマンス履歴を使用して、Office 365 のパフォーマンスをチューニングする

Office 365 と企業間の接続のパフォーマンスを確認する簡単な方法がいくつかあります。これにより、接続の大まかなベースラインを確立することができます。 クライアントコンピューター接続のパフォーマンス履歴を把握しておくと、問題を早期に発見し、問題を特定して予測するのに役立ちます。
  
パフォーマンスの問題に対処するために使用しない場合は、この記事でよく寄せられる質問のうち、Office 365 サービスインシデントではなくパフォーマンス上の問題が発生していることをどのように確認できるかについて説明します。 良好なパフォーマンスと長期的な計画をするにはどうすればよいですか? パフォーマンスを常に把握するには、どうすればよいですか。 Office 365 を使用しているときに、チームまたはクライアントでパフォーマンスが低下している場合は、次の点を確認してください。
  
> [!IMPORTANT]
> **現在、クライアントと Office 365 の間のパフォーマンスの問題がありますか?** 「 [Office 365 のパフォーマンストラブルシューティング計画](performance-troubleshooting-plan.md)」に記載されている手順に従います。 
    
## <a name="something-you-should-know-about-office-365-performance"></a>Office 365 のパフォーマンスについて理解しておくべきこと

Office 365 は、自動化だけでなく、実際のユーザーによって常時監視されている大容量の専用 Microsoft ネットワーク内に存在します。 Office 365 cloud のメンテナンスの役割の一部は、使用可能なパフォーマンスのチューニングと合理化を実現することです。 Office 365 クラウドのクライアントはインターネットを介して接続する必要があるため、Office 365 サービス全体でパフォーマンスを微調整するための継続的な取り組みがあります。 パフォーマンスの向上は、クラウドでは実際には停止しません。クラウドの正常性と迅速な維持には、多くの累積的な実績があります。 お客様の場所から Office 365 に接続してパフォーマンス上の問題が発生した場合は、まず、サポートケースを開始し、サポートを受けることをお勧めします。 代わりに、「インサイド out」から問題の調査を開始する必要があります。 つまり、ネットワークの内部から始めて、Office 365 に対処します。 Office 365 サポートを使用してケースを開く前に、データを収集し、問題を調査して解決する可能性があるアクションを実行することができます。
  
> [!IMPORTANT]
> Office 365 の容量計画と制限事項に注意してください。 この情報は、パフォーマンスの問題を解決しようとするときに、曲線の前に置きます。 ここでは、 [Microsoft 365 および Office 365 サービスの説明](https://docs.microsoft.com/office365/servicedescriptions/office-365-service-descriptions-technet-library)へのリンクを示します。 これは中央ハブで、Office 365 によって提供されるすべてのサービスには、ここからの独自のサービスの説明に行くリンクがあります。 つまり、sharepoint online の標準的な制限を確認する必要があるとします。たとえば、sharepoint online [サービスの説明](https://technet.microsoft.com/library/sharepoint-online-service-description.aspx) をクリックして、その sharepoint Online の [制限セクション](https://go.microsoft.com/fwlink/p/?LinkID=856113)を探します。 
  
パフォーマンスが変化していることを理解した上でトラブルシューティングを行ってください。これは、stressful の価値を実現し、永続的に保持することではありません (これがそうであれば、多くのユーザーが使用している場合や大規模なデータ移行を実行する場合など)、パフォーマンスへの影響を計画します。 パフォーマンス目標を大まかに理解しておくことができますが、多くの変数がパフォーマンスを向上させるため、パフォーマンスは異なります。 これはパフォーマンスの特性です。 
  
パフォーマンスのトラブルシューティングは、特定の目標を達成し、それらの番号を無期限に維持することではなく、すべての変数を指定して既存のアクティビティを改善することになります。 
  
## <a name="okay-what-does-a-performance-problem-look-like"></a>パフォーマンスの問題がどのようなものかを確認します。

最初に、発生していることがパフォーマンスの問題であり、サービスインシデントではないことを確認する必要があります。 パフォーマンスの問題は、Office 365 のサービスインシデントとは異なります。 それらを区別する方法は次のとおりです。
  
Office 365 サービスで問題が発生している場合は、サービスインシデントです。 Microsoft 365 管理センターの [現在の **稼働状態** ] の下に赤色または黄色のアイコンが表示されます。また、Office 365 に接続しているクライアントコンピューターのパフォーマンスが低下することがあります。 たとえば、現在の正常性レポートに赤いアイコンが表示されていて、Exchange の近くを **調査** している場合は、exchange Online を使用しているクライアントメールボックスが正しく動作していないことを示す、組織内のユーザーからの一連の呼び出しを受け取ることがあります。 その場合は、Exchange Online のパフォーマンスがサービス内の問題の被害になることを想定することが適切です。 
  
![Office 365 Health dashboard。グリーンは、Exchange を除くすべてのワークロードを使用して、復元されたサービスを示します。](../media/ec7f0325-9e61-4e1a-bec0-64b87f4469be.PNG)
  
この時点で、Office 365 管理者は、 **現在の状態** を確認してから、 **詳細と履歴を表示**して、システム上で実行する最新のメンテナンスについてよく把握する必要があります。 **現在の正常性**ダッシュボードにより、サービスに対する変更と問題の解決についての更新が行われました。 「Health history, admin to admin」に記載されているメモと説明は、影響を評価し、継続的な作業についての投稿を維持するのに役立ちます。 
  
![Exchange Online サービスが復元されたことと、その理由を説明する Office 365 正常性ダッシュボードの画像。](../media/66609554-426a-4448-8be6-ea09817f41ba.PNG)
  
パフォーマンスの問題は、インシデントがパフォーマンスを低下する可能性がある場合でも、サービスインシデントではありません。 パフォーマンスの問題は次のようになります。
  
- 管理センターの **現在の状態** がサービスについて報告しているかどうかに関係なく、パフォーマンスの問題が発生します。 
    
-  比較的シームレスに実行するために使用された動作は、完了または完了するまでに長い時間がかかります。 
    
- 問題を再現したり、少なくとも、適切な一連の手順を実行したときに発生することがわかっていることを確認することもできます。
    
-  問題が断続的に発生する場合は、たとえば、10:00 AM が Office 365 に安全にアクセスできないユーザーから電話をかけてきたことがわかっていること、およびその通話が正午まで停止するというパターンがあります。 
    
このことはよくご存知でしょう。なじみもありません。 パフォーマンスの問題があることがわかったら、「次に実行することは何ですか」という質問になります。 この記事の残りの部分では、正確に判断するのに役立つ情報を示します。
  
## <a name="how-to-define-and-test-the-performance-problem"></a>パフォーマンスの問題を定義してテストする方法

多くの場合、パフォーマンスの問題は時間の経過とともに浮上するため、実際の問題を定義するのは困難です。 適切な問題の説明を作成して、問題のコンテキストを明確に考えてから、テストの手順を繰り返し実行して、その日に勝利する必要があります。 それ以外の場合、独自の障害が発生しても、失われることがあります。 それはなぜでしょうか。 十分な情報が提供されない問題のステートメントの例を次に示します。
  
- 自分の受信トレイから予定表への切り替えは、自分が気付かなかったようになったので、今度はコーヒーブレイクになっています。 そのような機能を使用できるようにすることはできますか。
    
- SharePoint Online へのファイルのアップロードは永遠に行われます。 午後の間に遅くなるのはなぜですか。それ以外の場合は高速ですか。 すぐにはできませんか?
    
上記の問題のステートメントには、いくつかの大きな課題があります。 具体的には、対処に多くのあいまいさがあります。 例:
  
- これは、ラップトップの操作に使用される受信トレイと予定表を切り替える方法を明確にしています。
    
- ユーザーが "すぐにはできません" と言った場合、"fast" とは何ですか。
    
- どのくらいの期間が "無期限" か この数秒または数分の間、またはユーザーが昼休みに行くことができ、ユーザーが戻ってから10分後に完了したかどうか。
    
これらのすべてについて、管理者とトラブルシューティング者は、このような問題のステートメントから多くの詳細を認識できないということを考慮する必要はありません。 たとえば、問題が発生し始めたとき。ユーザーが自宅で作業していて、ホームネットワーク上の切り替えが低速であること。ユーザーがローカルクライアントで他の RAM を集中的に使用するアプリケーションを実行する必要がある場合、またはユーザーが以前のオペレーティングシステムを実行しているか、最近の更新プログラムを実行していない場合。
  
ユーザーがパフォーマンスの問題を報告する場合は、収集する情報がたくさんあります。 この情報を収集することは、問題の範囲指定または調査と呼ばれるプロセスの一部です。 以下に、パフォーマンスの問題に関する情報を収集するために使用できる基本的なスコープリストを示します。 この一覧は網羅的なものではありませんが、自分で開始する場所です。 
  
- 問題が発生した日付と、その時刻または夜
    
- どのような種類のクライアントコンピューターを使用していたか。また、どのようにしてビジネスネットワーク (VPN、有線、ワイヤレス) に接続しますか。
    
- リモートで作業したのか、または office で作業したか。
    
- 別のコンピューターで同じ操作を試してみましたが、同じ現象が表示されますか。
    
- 問題を発生させる手順に従って、実行するアクションを記述できるようにします。
    
- パフォーマンスは秒または分で遅くなりますか?
    
- 世界のどこに配置していますか?
    
これらの質問の中には、他のものよりもわかりやすいものがあります。 ほとんどのユーザーは、問題を再現するための正確な手順を必要とすることをよく理解しています。 それでは、どのような状況で問題が発生しているのか、どのような場合に問題が修正されたかどうかをどのようにして記録できるか。 明白なのは、"どの日付と時刻に問題が発生しましたか?" や "世界のどこに存在していますか?" というようなものです。 ユーザーがどのような状況で作業していたかによって、時間差は、会社のネットワークの一部でメンテナンスが既に進行していることを意味します。 たとえば、ハイブリッド実装では、SharePoint Online とオンプレミスの SharePoint Server 2013 インスタンスの両方の検索インデックスをクエリできるハイブリッドな SharePoint 検索などのハイブリッド実装が会社にある場合、オンプレミスのファームで更新が進行している可能性があります。 企業がクラウド内にいる場合、システムの保守には、ネットワークハードウェアの追加または削除、全社的な更新プログラムのロールアウト、DNS やその他のコアインフラストラクチャへの変更などが含まれます。
  
パフォーマンスの問題のトラブルシューティングを行う場合は、犯罪に似た方法があります。証拠からすべての結論を求めるには、正確かつ observant を使用する必要があります。 これを行うには、証拠を収集することによって、適切な問題のステートメントを取得する必要があります。 これには、コンピューターのコンテキスト、ユーザーのコンテキスト、問題が発生した日時、およびパフォーマンスの問題を発生させる正確な手順が含まれている必要があります。 この問題のステートメントは、ノートの一番上にあるページに入ります。 解決策で作業した後に問題のステートメントを再度調査することにより、実行するアクションが問題を解決したかどうかをテストして確認することができます。 これは、いつ作業が終わったかを知る上で重要です。
  
## <a name="do-you-know-how-performance-used-to-look-when-it-was-good"></a>パフォーマンスが良好であるかどうかを確認しますか。

Unlucky の場合、誰も知りません。 何も番号を持っていません。 そのため、誰でも、「Office 365 で受信トレイを起動するのに使用した時間について」、または「役員が Lync Online 会議を開催したときにどのくらい時間がかかったか」という簡単な質問に回答することができます。これは、多くの企業に共通のシナリオです。
  
ここで不足しているのはパフォーマンスベースラインです。
  
ベースラインを使用すると、パフォーマンスのコンテキストがわかります。 会社のニーズに応じて、基準計画を頻繁に実行する必要があります。 大規模な企業の場合、運用チームは既にオンプレミス環境のベースラインを使用する場合があります。 たとえば、月の第1月曜日にすべての Exchange サーバーを修正し、3番目の月曜日にすべての SharePoint サーバーにパッチを適用した場合、運用チームは、重要な機能が動作していることを確認するために、パッチ適用後に実行されたタスクとシナリオのリストを持っている可能性があります。 たとえば、受信トレイを開いて、[送受信] をクリックし、フォルダーが更新されていることを確認します。 SharePoint では、サイトのメインページを参照し、エンタープライズ検索ページに移動して、結果を返す検索を実行します。
  
アプリケーションが Office 365 にある場合は、ネットワーク内のクライアントコンピューターから、出口ポイント、またはネットワークから離れた場所に Office 365 に移行する時間 (ミリ秒単位) を測定するために、最も基本的な基準の一部を使用できます。 以下に、調査および記録できるいくつかの参考基準を示します。
  
- クライアントコンピューターと出口ポイントの間のデバイス (たとえば、プロキシサーバー) を特定します。
    
  - パフォーマンスの問題が発生した場合に、コンテキスト (IP アドレス、デバイスの種類、et cetera) があることをデバイスに通知する必要があります。
    
  - プロキシサーバーは一般的な出口ポイントなので、web ブラウザーでどのプロキシサーバーが使用されているかを確認できます。
    
  - ネットワークを検出してマップできるサードパーティ製のツールがありますが、デバイスを最も安全に知る方法は、ネットワークチームのメンバーに依頼することです。
    
- インターネットサービスプロバイダー (ISP) を特定し、連絡先情報を書き留め、どの程度の帯域幅を使用しているかを確認します。
    
- 社内で、クライアントと出口の間にあるデバイスのリソースを特定するか、ネットワークの問題について説明する緊急連絡先を特定します。
    
以下に、ツールを使用した簡単なテストで計算できる基準をいくつか示します。
  
- クライアントコンピューターから出口ポイントまでの時間 (ミリ秒)
    
- 出口ポイントから Office 365 までの時間 (ミリ秒)
    
- 参照時に Office 365 の URL を解決する、サーバーの世界の場所
    
- ISP の DNS 解決の速度 (ミリ秒)、パケット到着 (ネットワークのジッター) の不整合、アップロード時間とダウンロード時間 (ミリ秒)
    
これらの手順を実行する方法についてよく知らない場合は、この記事の詳細をご覧ください。 
  
## <a name="what-is-a-baseline"></a>ベースラインとは

障害が発生した場合の影響について理解していますが、過去のパフォーマンスデータがわからない場合は、どのような状況が発生しているか、およびいつ発生したかについてのコンテキストを設定することはできません。 そのため、ベースラインを使用しないと、パズルを解決するための重要な手掛かりとして、パズルボックスに画像が表示されていないことがわかります。 パフォーマンスのトラブルシューティングでは、  *比較*  のポイントが必要です。 シンプルなパフォーマンスベースラインを実行することは困難です。 運用チームは、これらをスケジュールに基づいて実施することができます。 たとえば、次のような接続があるとします。 
  
![クライアント、プロキシ、および Office 365 のクラウドを示す基本的なネットワークグラフィックス。](../media/c6ca7140-09f9-4c2d-a775-dbf2820eaa0c.PNG)
  
これは、ネットワークチームに確認して、プロキシサーバーを介してインターネットを使用していて、そのプロキシが、クライアントコンピューターがクラウドに送信するすべての要求を処理することを検出したことを意味します。 この場合、介在するすべてのデバイスを一覧表示する簡略版の接続を描画する必要があります。 これで、クライアント、出口ポイント (ネットワークを使用してインターネットに接続した場所)、および Office 365 cloud の間のパフォーマンスをテストするために使用できるツールが挿入されました。
  
![クライアント、プロキシ、クラウドを使用した基本的なネットワークと、PSPing、TraceTCP、およびネットワークトレースについて提案するツール。](../media/627bfb77-abf7-4ef1-bbe8-7f8cbe48e1d2.png)
  
これらのオプションは、パフォーマンスデータを検索するために必要な専門知識があるため、 **シンプル** で、かつ **高度** なものとして一覧表示されます。 ネットワークトレースには、PsPing や TraceTCP のようなコマンドラインツールの実行と比較して、多くの時間がかかります。 これらの2つのコマンドラインツールは、Office 365 によってブロックされる ICMP パケットを使用しないため、またはクライアントコンピューターを離れる時間 (アクセス可能な場合) や Office 365 に到着するまでの時間をミリ秒単位で提供するために選択されました。 1台のコンピューターから別のコンピューターへの各ホップは、時刻の値を設定することができるので、ベースラインに適しています。 重要なのは、これらのコマンドラインツールを使用すると、コマンドにポート番号を追加することができます。これは、Office 365 がポート443を介して通信するために役立ちます。これは、Secure Sockets Layer とトランスポート層セキュリティ (SSL および TLS) で使用されるポートです。 ただし、他のサードパーティ製ツールでは、状況に応じたソリューションが適している場合があります。 Microsoft では、これらのツールのすべてがサポートされていないため、何らかの理由で PsPing および TraceTCP の動作を取得できない場合は、Netmon のようなツールを使用してネットワークトレースに移行します。 
  
業務時間外に基準計画を作成し、その後で時間の経過とともに再び使用することができます。 つまり、最後に次のような形式のフォルダー構造があるということです。
  
![パフォーマンス データをフォルダーに整理する方法を提示している図。](../media/13e01ffa-f0f2-4d10-b89d-d5980ec89fae.png)
  
また、ファイルの名前付け規則を選択する必要があります。 次に、いくつかの例を示します:
  
- Feb_09_2015_9amPST_PerfBaseline_Netmon_ClientToEgress_Normal
    
- Jan_10_2015_3pmCST_PerfBaseline_PsPing_ClientToO365_bypassProxy_SLOW
    
- Feb_08_2015_2pmEST_PerfBaseline_BADPerf
    
- Feb_08_2015_8-30amEST_PerfBaseline_GoodPerf
    
これを行うにはさまざまな方法がありますが、その形式を使用して始めることを **\<dateTime\>\<what's happening in the test\>** お勧めします。 このことを入念に確認しておくと、後で問題をトラブルシューティングする際に多くのことができます。 後で、"2 月8日に2つのトレースを使用しました。1つは良好なパフォーマンスを示し、不良があることがわかりました。それらを比較できるようになりました" と言うことができます。 これは、トラブルシューティングに非常に役立ちます。 
  
過去のベースラインを維持するための方法を整理する必要があります。 この例では、単純なメソッドによって3つのコマンドライン出力が生成され、結果がスクリーンショットとして収集されましたが、代わりにネットワークキャプチャファイルを使用している可能性があります。 適切に機能するメソッドを使用します。 過去のベースラインを保存し、オンラインサービスの動作に変化がある点を参照してください。 
  
## <a name="why-collect-performance-data-during-a-pilot"></a>パイロット時にパフォーマンスデータを収集する理由

Office 365 サービスのパイロットと比較して、ベースラインを開始する時間を短縮することはできません。 Office には、数千人のユーザー、数十万、または5人がいる場合がありますが、ユーザー数が少ない場合でも、パフォーマンスの変動を測定するテストを実行することができます。 大規模な企業の場合、数百のユーザーの代表的なサンプルである Office 365 を試験的に実行することで、問題が発生する前に問題が発生する可能性があることを知ることができます。
  
小規模な企業の場合は、すべてのユーザーが同時にサービスに移動し、パイロットが存在しないことを意味するため、パフォーマンスを維持して、ユーザーが不適切な操作を実行する際にトラブルシューティングが必要になる可能性があるユーザーに対して表示するデータを確保できます。 たとえば、非常に短時間で使用されていた中規模のグラフィックスをアップロードする時間に、建物を一周することができます。
  
## <a name="how-to-collect-baselines"></a>ベースラインを収集する方法

すべてのトラブルシューティングプランでは、少なくとも次のことを特定する必要があります。
  
- 使用しているクライアントコンピューター (コンピューターまたはデバイスの種類、IP アドレス、問題の原因となったアクション)
    
- クライアントコンピューターが世界に配置されている場所 (たとえば、このユーザーがネットワークに VPN 経由でリモートで作業しているか、または会社のイントラネット上にあるか)
    
- クライアントコンピューターがネットワークから使用する出口ポイント (ISP またはインターネットに対してトラフィックが発生したポイント)
    
 ネットワークのレイアウトは、ネットワーク管理者から確認できます。 小規模なネットワークを使用している場合は、インターネットに接続されているデバイスを調べ、レイアウトについての質問がある場合は、ISP にお問い合わせください。 参照用の最終的なレイアウトのグラフィックを作成します。 
  
このセクションは、シンプルなコマンドラインツールとメソッド、および高度なツールオプションに分かれています。 最初に、単純な方法について説明します。 ただし、現時点でパフォーマンスの問題が発生している場合は、高度な方法に進んで、サンプルのパフォーマンスのトラブルシューティングアクションプランを試す必要があります。
  
### <a name="simple-methods"></a>単純なメソッド

これらの簡単な方法の目的は、時間の経過とともに単純なパフォーマンス基準を取得、理解、および適切に保存する方法を学習することです。これにより、Office 365 のパフォーマンスについて通知されます。 前にも説明したように、単純な単純な図を次に示します。
  
![クライアント、プロキシ、クラウドを使用した基本的なネットワークと、PSPing、TraceTCP、およびネットワークトレースについて提案するツール。](../media/627bfb77-abf7-4ef1-bbe8-7f8cbe48e1d2.png)
  
> [!NOTE]
> このスクリーンショットは、このスクリーンショットに含まれています。これは、要求が処理されるまでの時間をミリ秒単位で表示するための便利なツールであり、1台のコンピューターから次のコンピューターへの接続によって宛先に到達するまでの接続の数を示します。 TraceTCP は、ホップ時に使用されるサーバーの名前を指定することもできます。これは、サポートの Microsoft Office 365 のトラブルシューティングに役立ちます。 > TraceTCP コマンドは、次のような単純なものにすることができます。 >  `tracetcp.exe outlook.office365.com:443`> コマンドにポート番号を含めることを忘れないでください。 > [Tracetcp](https://simulatedsimian.github.io/tracetcp_download.html) は無料でダウンロードできますが、wincap に依存します。 Wincap は、Netmon でも使用され、インストールされているツールです。 「Advanced メソッド」セクションでも Netmon を使用しています。 
  
 複数のオフィスがある場合は、それぞれの場所にクライアントのデータセットも保持する必要があります。 このテストでは待機時間が測定されます。この値は、クライアントが Office 365 に要求を送信してから、Office 365 が要求に応答するまでの時間を表す数値です。 このテストは、クライアントコンピューター上のドメイン内で行われ、ネットワーク内部から、出口ポイントから、インターネットを介して Office 365 に至るまでのラウンドトリップを測定するようになります。 
  
出口ポイント (この場合はプロキシサーバー) を処理するには、いくつかの方法があります。 1から2、2から3までトレースすることができ、その数をミリ秒単位で追加して、ネットワークのエッジに最終的な合計を取得することができます。 または、Office 365 アドレスのプロキシをバイパスするように接続を構成することができます。 ファイアウォール、リバースプロキシ、またはこの2つの組み合わせを備えた大規模なネットワークでは、多くの Url にトラフィックを渡すことができるようにするために、プロキシサーバー上で例外を作成する必要があります。 Office 365 で使用されるエンドポイントの一覧については、「 [office 365 の url と IP アドレスの範囲](https://support.office.com/article/8548a211-3fe7-47cb-abb1-355ea5aa88a2)」を参照してください。 認証プロキシを使用している場合は、まず、以下の例外をテストします。
  
- ポート80および443
    
- TCP および HTTPs
    
- これらの Url のいずれかに送信される接続:
    
- \*. microsoftonline.com
    
- \*. microsoftonline-p.com
    
- \*.sharepoint.com
    
- \*. outlook.com
    
- \*. lync.com
    
- osub.microsoft.com
    
すべてのユーザーは、プロキシの干渉や認証を行わずに、これらのアドレスにアクセスできるようにする必要があります。 小規模なネットワークでは、web ブラウザーのプロキシバイパスリストにこれらを追加する必要があります。 
  
Internet Explorer のプロキシバイパスリストにこれらを追加するには、[ **ツール**] [ \> **インターネットオプション**] [ \> **接続** \> **LAN の設定**] \> **[詳細**] に移動します。 [詳細設定] タブには、プロキシサーバーとプロキシサーバーのポートも表示されます。 [**詳細設定**] ボタンにアクセスするには、[ **LAN にプロキシサーバーを使用**する] チェックボックスをオンにする必要がある場合があります。 **ローカルアドレスにはプロキシサーバーを使用**しないことを確認するようにします。 [ **詳細設定**] をクリックすると、例外を入力できるテキストボックスが表示します。 上記のワイルドカード Url はセミコロンで区切ります。たとえば、次のように記述します。
  
\*. microsoftonline.com; \*. sharepoint.com
  
プロキシをバイパスすると、Office 365 URL で直接 ping または PsPing を使用できるようになります。 次の手順では、ping **outlook.office365.com**をテストします。 または、PsPing を使用している場合、またはコマンドにポート番号を指定する別のツールを使用している場合は、 **portal.microsoftonline.com:443** に対する psping がミリ秒単位の平均ラウンドトリップ時間を確認します。 
  
ラウンドトリップ時間 (RTT) は、outlook.office365.com のようなサーバーに HTTP 要求を送信するのにかかる時間を測定する数値です。この値は、サーバーに認識されたことを確認する応答を取得します。 この省略形が RTT として表示されることがあります。 この値は比較的短時間である必要があります。
  
このテストを行うには、Office 365 によってブロックされる ICMP パケットを使用しない、 [Psping](https://technet.microsoft.com/sysinternals/jj729731.aspx) または他のツールを使用する必要があります。 
  
 **PsPing を使用して Office 365 URL から直接のラウンドトリップ時間をミリ秒単位で取得する方法**
  
1. 次の手順を実行して、管理者特権でのコマンドプロンプトを実行します。
    
1. **[開始]** をクリックします。
    
2. [ **検索の開始** ] ボックスに「cmd」と入力し、CTRL + SHIFT + enter キーを押します。
    
3. **[ユーザー アカウント制御]** ダイアログ ボックスが表示された場合、このボックスに希望する動作が表示されていることを確認し、**[継続]** をクリックします。
    
2. ツール (この場合は PsPing) がインストールされているフォルダーに移動し、これらの Office 365 の Url をテストします。
    
  - psping portal.office.com:443
    
  - psping microsoft-my.sharepoint.com:443
    
  - psping outlook.office365.com:443
    
  - psping www.yammer.com:443
    
    ![PSPing コマンドは microsoft-my.sharepoint.com ポート443に送られます。](../media/3258f620-4513-4e82-95c9-06b387fc3a82.PNG)
  
443のポート番号が含まれていることを確認してください。 Office 365 は暗号化されたチャネルで動作することに注意してください。 ポート番号を指定せずに PsPing を行うと、要求は失敗します。 短い一覧で ping を実行したら、平均時間 (ミリ秒) を探します。 これで、記録することができます。
  
![2.8 ミリ秒のラウンドトリップ時間を使用して、PSPing をプロキシするクライアントの図を示す図。](../media/96901aea-1093-4f1b-b5a3-6078e9035e6c.png)
  
プロキシバイパスに慣れておらず、手順を追って説明したい場合は、まずプロキシサーバーの名前を確認する必要があります。 Internet Explorer で、[**ツール** \> **] [インターネットオプション]** [ \> **接続**LAN の設定] の \> **LAN settings** \> **[詳細**] に移動します。 **[詳細設定**] タブには、プロキシサーバーの一覧が表示されます。 このタスクを完了することで、プロキシサーバーに対してコマンドプロンプトで Ping を実行します。 
  
 **プロキシサーバーに対して ping を行い、ステージ1から2のラウンドトリップ値をミリ秒単位で取得するには**
  
1. 次の手順を実行して、管理者特権でのコマンドプロンプトを実行します。
    
1. **[開始]** をクリックします。
    
2. [ **検索の開始** ] ボックスに「cmd」と入力し、CTRL + SHIFT + enter キーを押します。
    
3. **[ユーザー アカウント制御]** ダイアログ ボックスが表示された場合、このボックスに希望する動作が表示されていることを確認し、**[継続]** をクリックします。
    
2. Ping と入力し \<the name of the proxy server your browser uses, or the IP address of the proxy server\> 、enter キーを押します。 PsPing またはその他のツールがインストールされている場合は、代わりにそのツールを使用することを選択できます。 
    
    コマンドは、次の例のいずれかのようになります。 
    
  - ping ourproxy.ourdomain.industry.business.com
    
  - ping 155.55.121.55
    
  - ping ourproxy
    
  - psping ourproxy.ourdomain.industry.business.com:80
    
  - psping 155.55.121.55:80
    
  - psping ourproxy:80
    
3. トレースがテストパケットの送信を停止すると、平均時間 (ミリ秒単位) を示す小さな要約が表示され、それが後の値となります。 プロンプトのスクリーンショットを取り、名前付け規則を使用して保存します。 この時点で、図面に値を入力することもできます。
    
早朝にトレースを取得した場合は、クライアントがプロキシ (または、インターネットに接続されている場合は、インターネットに接続されている) をすばやく受信することができます。 この場合、数字は次のようになります。
  
![クライアントからプロキシへのラウンドトリップ時間が2.8 ミリ秒であることを示す図。](../media/1bd03544-23fc-47d4-bbae-c1feb466a5d8.PNG)
  
クライアントコンピューターがプロキシ (または出口) サーバーへのアクセスによる select 数台のうちの1つである場合は、そのコンピューターにリモートで接続することによってテストの次の区間を実行し、そこから Office 365 URL に対して PsPing に対してコマンドプロンプトを実行することができます。 そのコンピューターにアクセスできない場合は、ネットワークリソースに連絡して、次の区間に関するヘルプを参照し、正確な番号を入手できます。 これができない場合は、問題の Office 365 URL に対して PsPing を取得して、それを PsPing または Ping 時間とプロキシサーバーと比較します。 
  
たとえば、クライアントから Office 365 URL に51.84 ミリ秒、クライアントからプロキシ (または出口ポイント) に対して2.8 ミリ秒を使用している場合は、365 Office の出口からの間で49.04 ミリ秒を使用します。 同様に、1日の高さの間、クライアントからプロキシに12.25 ミリ秒の PsPing があり、クライアントから Office 365 URL への62.01 ミリ秒の場合は、プロキシが Office の 365 URL に出力されるまでの平均値は49.76 ミリ秒です。
  
![クライアントから Office 365 へのクライアントの横のプロキシへの ping をミリ秒単位で示す追加のグラフィックスを使用して、値を差し引くことができます。](../media/cd764e77-5154-44ba-a5cd-443a628eb2d9.PNG)
  
トラブルシューティングに関しては、これらのベースラインを保持するだけで興味深い点があるかもしれません。 たとえば、一般に、プロキシまたはアウトポイントから Office 365 URL への待機時間が約 40 ~ 59 ミリ秒であることが判明した場合は、また、クライアントのプロキシまたは出口に約 3 ~ 7 ミリ秒の待機時間がある場合は、最後の3つのクライアントが proxy または出口のベースラインで遅延が45ミリ秒を示していると、問題があることがわかります。
  
### <a name="advanced-methods"></a>高度なメソッド

Office 365 へのインターネット要求の発生状況を本当に把握したい場合は、ネットワークトレースについて理解しておく必要があります。 これらのトレースにどのツールを使用してもかまいません。 HTTPWatch、Netmon、Message Analyzer、Wireshark、Fiddler、Developer Dashboard ツール、またはその他の方法は、そのツールがネットワークトラフィックをキャプチャしてフィルター処理できる限り同じように実行されます。 このセクションでは、このようなツールの複数を実行して、問題の完全な図を取得することをお勧めします。 テストしている場合、これらのツールの一部は、独自の権限でプロキシとしても機能します。 この記事で使用されているツール ( [Office 365 のパフォーマンストラブルシューティング計画](performance-troubleshooting-plan.md)) には、 [Netmon 3.4](https://www.microsoft.com/download/details.aspx?id=4865)、 [Httpwatch](https://www.httpwatch.com/download/)、または [WireShark](https://www.wireshark.org/)が含まれます。
  
パフォーマンスベースラインはこの方法の単純な部分であり、多くの手順はパフォーマンスの問題をトラブルシューティングする場合と同じです。 パフォーマンスのベースラインを作成するためのより高度な方法では、ネットワークトレースを取得して保存する必要があります。 この記事の例のほとんどは SharePoint Online を使用していますが、テストと記録に加入する Office 365 サービス全体に共通するアクションの一覧を作成する必要があります。 ベースラインの例を次に示します。
  
- SPO のベースラインリスト-* * ステップ 1: * * SPO web サイトのホームページを参照し、ネットワークトレースを行います。 トレースを保存します。 
    
- SPO のベースラインリスト- **ステップ 2:** エンタープライズ検索を使用して用語 (会社名など) を検索し、ネットワークトレースを実行します。 トレースを保存します。 
    
- SPO のベースラインリスト- **手順 3:** SharePoint Online ドキュメントライブラリに大きなファイルをアップロードし、ネットワークトレースを実行します。 トレースを保存します。 
    
- SPO のベースラインリスト- **手順 4:** OneDrive web サイトのホームページを参照し、ネットワークトレースを実行します。 トレースを保存します。 
    
このリストには、SharePoint Online に対してユーザーが実行する最も重要な共通のアクションが含まれている必要があります。 OneDrive for business への移行を追跡するための最後の手順では、SharePoint Online ホームページ (企業によってカスタマイズされることが多い) と OneDrive for Business ホームページの負荷の比較について説明します。これはあまりカスタマイズされていません。 これは、負荷のかかる SharePoint Online サイトに関する非常に基本的なテストです。 テストには、この違いの記録を作成できます。
  
パフォーマンスの問題が発生している場合、多くの手順はベースラインを取る場合と同じです。 ネットワークトレースは重要になるので、次に重要なトレースを実行する  *方法*  を取り扱います。 
  
パフォーマンスの問題に対処するに  *は、パフォーマンス*  の問題が発生しているときにトレースを行う必要があります。 適切なツールを使用してログを収集する必要があります。また、アクションプランを用意しておく必要があります。これは、可能な限りよい情報を収集するためのトラブルシューティングアクションの一覧です。 最初に行う必要があるのは、タイミングを反映したフォルダーにファイルを保存できるように、テストの日付と時刻を記録することです。 次に、問題の手順自体に絞り込みます。 以下に、テストに使用する正確な手順を示します。 次の基本事項を忘れないでください。問題が Outlook にのみある場合は、1つの Office 365 サービスでのみ問題が発生することを記録してください。 この問題の範囲を絞ることで、解決できるものに集中することができます。 
  
## <a name="see-also"></a>関連項目

[Office 365 エンドポイントの管理](https://support.office.com/article/99cab9d4-ef59-4207-9f2b-3728eb46bf9a)

